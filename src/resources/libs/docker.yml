parameters:
    docker_images_prefix: ~
    docker_image_folder: ./docker/images/
    docker_shell: bash

commands:
    "docker:open":
        type: docker
        script:
            - view://WARNING - DEPRECATED
            - view://Integrated libraries have been moved from "vendor/worldfactory/qq/src/resources/lib" to "vendor/worldfactory/qq/resources/lib". From version 2.0, they will become unavailable from the previous path.
            - "%docker_shell%"
        options:
            target: "%1%"
        shortDescription: Open shell in target container.
        longDescription: Need a target environment name.
        aliases: [bash, open, "docker:bash"]

    "docker:log":
        script:
            - view://WARNING - DEPRECATED
            - view://Integrated libraries have been moved from "vendor/worldfactory/qq/src/resources/lib" to "vendor/worldfactory/qq/resources/lib". From version 2.0, they will become unavailable from the previous path.
            - docker-compose logs -f %_all%
        shortDescription : Display logs.
        aliases: [log]

    "docker:reboot":
        script:
            - view://WARNING - DEPRECATED
            - view://Integrated libraries have been moved from "vendor/worldfactory/qq/src/resources/lib" to "vendor/worldfactory/qq/resources/lib". From version 2.0, they will become unavailable from the previous path.
            - docker-compose halt && docker-compose up -d %_all%
        shortDescription: Reboot all containers.
        aliases: [reboot]

    "docker:up":
        script:
            - view://WARNING - DEPRECATED
            - view://Integrated libraries have been moved from "vendor/worldfactory/qq/src/resources/lib" to "vendor/worldfactory/qq/resources/lib". From version 2.0, they will become unavailable from the previous path.
            - docker-compose up -d %_all%
        shortDescription: Starts containers as daemons.
        aliases: [up]

    "docker:build":
        script:
            - view://WARNING - DEPRECATED
            - view://Integrated libraries have been moved from "vendor/worldfactory/qq/src/resources/lib" to "vendor/worldfactory/qq/resources/lib". From version 2.0, they will become unavailable from the previous path.
            - docker build %docker_image_folder%%1% --tag %docker_images_prefix%%1%:latest %_left%
            - docker-compose up -d %1%
        shortDescription: Rebuilt a container locally.
        aliases: [build]

    "docker:clean":
        script:
            - view://WARNING - DEPRECATED
            - view://Integrated libraries have been moved from "vendor/worldfactory/qq/src/resources/lib" to "vendor/worldfactory/qq/resources/lib". From version 2.0, they will become unavailable from the previous path.
            - docker-compose down --remove-orphans
            - exec://docker system prune -a --volumes
        shortDescription: Cleaning unused Docker images and volumes.
        aliases: [clean]

    "docker:down":
        script:
            - view://WARNING - DEPRECATED
            - view://Integrated libraries have been moved from "vendor/worldfactory/qq/src/resources/lib" to "vendor/worldfactory/qq/resources/lib". From version 2.0, they will become unavailable from the previous path.
            - docker-compose down --remove-orphans %_all%
        shortDescription: Disable Docker containers.
        aliases: [down]

    "docker:restart":
        script:
            - view://WARNING - DEPRECATED
            - view://Integrated libraries have been moved from "vendor/worldfactory/qq/src/resources/lib" to "vendor/worldfactory/qq/resources/lib". From version 2.0, they will become unavailable from the previous path.
            - docker stop %1% && docker start %1%
        shortDescription: Restart target container.
        aliases: [restart]
